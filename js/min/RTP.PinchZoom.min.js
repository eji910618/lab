!function(){var t=this,n=t._,e={},i=Array.prototype,r=Object.prototype,o=Function.prototype,a=i.push,u=i.slice,s=i.concat,c=r.toString,l=r.hasOwnProperty,f=i.forEach,h=i.map,p=i.reduce,m=i.reduceRight,d=i.filter,g=i.every,v=i.some,y=i.indexOf,x=i.lastIndexOf,b=Array.isArray,w=Object.keys,z=o.bind,T=function(t){return t instanceof T?t:this instanceof T?void(this._wrapped=t):new T(t)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=T),exports._=T):t._=T,T.VERSION="1.5.1";var A=T.each=T.forEach=function(t,n,i){if(null!=t)if(f&&t.forEach===f)t.forEach(n,i);else if(t.length===+t.length){for(var r=0,o=t.length;o>r;r++)if(n.call(i,t[r],r,t)===e)return}else for(var a in t)if(T.has(t,a)&&n.call(i,t[a],a,t)===e)return};T.map=T.collect=function(t,n,e){var i=[];return null==t?i:h&&t.map===h?t.map(n,e):(A(t,function(t,r,o){i.push(n.call(e,t,r,o))}),i)};var F="Reduce of empty array with no initial value";T.reduce=T.foldl=T.inject=function(t,n,e,i){var r=arguments.length>2;if(null==t&&(t=[]),p&&t.reduce===p)return i&&(n=T.bind(n,i)),r?t.reduce(n,e):t.reduce(n);if(A(t,function(t,o,a){r?e=n.call(i,e,t,o,a):(e=t,r=!0)}),!r)throw new TypeError(F);return e},T.reduceRight=T.foldr=function(t,n,e,i){var r=arguments.length>2;if(null==t&&(t=[]),m&&t.reduceRight===m)return i&&(n=T.bind(n,i)),r?t.reduceRight(n,e):t.reduceRight(n);var o=t.length;if(o!==+o){var a=T.keys(t);o=a.length}if(A(t,function(u,s,c){s=a?a[--o]:--o,r?e=n.call(i,e,t[s],s,c):(e=t[s],r=!0)}),!r)throw new TypeError(F);return e},T.find=T.detect=function(t,n,e){var i;return O(t,function(t,r,o){return n.call(e,t,r,o)?(i=t,!0):void 0}),i},T.filter=T.select=function(t,n,e){var i=[];return null==t?i:d&&t.filter===d?t.filter(n,e):(A(t,function(t,r,o){n.call(e,t,r,o)&&i.push(t)}),i)},T.reject=function(t,n,e){return T.filter(t,function(t,i,r){return!n.call(e,t,i,r)},e)},T.every=T.all=function(t,n,i){n||(n=T.identity);var r=!0;return null==t?r:g&&t.every===g?t.every(n,i):(A(t,function(t,o,a){return(r=r&&n.call(i,t,o,a))?void 0:e}),!!r)};var O=T.some=T.any=function(t,n,i){n||(n=T.identity);var r=!1;return null==t?r:v&&t.some===v?t.some(n,i):(A(t,function(t,o,a){return r||(r=n.call(i,t,o,a))?e:void 0}),!!r)};T.contains=T.include=function(t,n){return null==t?!1:y&&t.indexOf===y?-1!=t.indexOf(n):O(t,function(t){return t===n})},T.invoke=function(t,n){var e=u.call(arguments,2),i=T.isFunction(n);return T.map(t,function(t){return(i?n:t[n]).apply(t,e)})},T.pluck=function(t,n){return T.map(t,function(t){return t[n]})},T.where=function(t,n,e){return T.isEmpty(n)?e?void 0:[]:T[e?"find":"filter"](t,function(t){for(var e in n)if(n[e]!==t[e])return!1;return!0})},T.findWhere=function(t,n){return T.where(t,n,!0)},T.max=function(t,n,e){if(!n&&T.isArray(t)&&t[0]===+t[0]&&t.length<65535)return Math.max.apply(Math,t);if(!n&&T.isEmpty(t))return-1/0;var i={computed:-1/0,value:-1/0};return A(t,function(t,r,o){var a=n?n.call(e,t,r,o):t;a>i.computed&&(i={value:t,computed:a})}),i.value},T.min=function(t,n,e){if(!n&&T.isArray(t)&&t[0]===+t[0]&&t.length<65535)return Math.min.apply(Math,t);if(!n&&T.isEmpty(t))return 1/0;var i={computed:1/0,value:1/0};return A(t,function(t,r,o){var a=n?n.call(e,t,r,o):t;a<i.computed&&(i={value:t,computed:a})}),i.value},T.shuffle=function(t){var n,e=0,i=[];return A(t,function(t){n=T.random(e++),i[e-1]=i[n],i[n]=t}),i};var _=function(t){return T.isFunction(t)?t:function(n){return n[t]}};T.sortBy=function(t,n,e){var i=_(n);return T.pluck(T.map(t,function(t,n,r){return{value:t,index:n,criteria:i.call(e,t,n,r)}}).sort(function(t,n){var e=t.criteria,i=n.criteria;if(e!==i){if(e>i||void 0===e)return 1;if(i>e||void 0===i)return-1}return t.index<n.index?-1:1}),"value")};var j=function(t,n,e,i){var r={},o=_(null==n?T.identity:n);return A(t,function(n,a){var u=o.call(e,n,a,t);i(r,u,n)}),r};T.groupBy=function(t,n,e){return j(t,n,e,function(t,n,e){(T.has(t,n)?t[n]:t[n]=[]).push(e)})},T.countBy=function(t,n,e){return j(t,n,e,function(t,n){T.has(t,n)||(t[n]=0),t[n]++})},T.sortedIndex=function(t,n,e,i){e=null==e?T.identity:_(e);for(var r=e.call(i,n),o=0,a=t.length;a>o;){var u=o+a>>>1;e.call(i,t[u])<r?o=u+1:a=u}return o},T.toArray=function(t){return t?T.isArray(t)?u.call(t):t.length===+t.length?T.map(t,T.identity):T.values(t):[]},T.size=function(t){return null==t?0:t.length===+t.length?t.length:T.keys(t).length},T.first=T.head=T.take=function(t,n,e){return null==t?void 0:null==n||e?t[0]:u.call(t,0,n)},T.initial=function(t,n,e){return u.call(t,0,t.length-(null==n||e?1:n))},T.last=function(t,n,e){return null==t?void 0:null==n||e?t[t.length-1]:u.call(t,Math.max(t.length-n,0))},T.rest=T.tail=T.drop=function(t,n,e){return u.call(t,null==n||e?1:n)},T.compact=function(t){return T.filter(t,T.identity)};var E=function(t,n,e){return n&&T.every(t,T.isArray)?s.apply(e,t):(A(t,function(t){T.isArray(t)||T.isArguments(t)?n?a.apply(e,t):E(t,n,e):e.push(t)}),e)};T.flatten=function(t,n){return E(t,n,[])},T.without=function(t){return T.difference(t,u.call(arguments,1))},T.uniq=T.unique=function(t,n,e,i){T.isFunction(n)&&(i=e,e=n,n=!1);var r=e?T.map(t,e,i):t,o=[],a=[];return A(r,function(e,i){(n?i&&a[a.length-1]===e:T.contains(a,e))||(a.push(e),o.push(t[i]))}),o},T.union=function(){return T.uniq(T.flatten(arguments,!0))},T.intersection=function(t){var n=u.call(arguments,1);return T.filter(T.uniq(t),function(t){return T.every(n,function(n){return T.indexOf(n,t)>=0})})},T.difference=function(t){var n=s.apply(i,u.call(arguments,1));return T.filter(t,function(t){return!T.contains(n,t)})},T.zip=function(){for(var t=T.max(T.pluck(arguments,"length").concat(0)),n=new Array(t),e=0;t>e;e++)n[e]=T.pluck(arguments,""+e);return n},T.object=function(t,n){if(null==t)return{};for(var e={},i=0,r=t.length;r>i;i++)n?e[t[i]]=n[i]:e[t[i][0]]=t[i][1];return e},T.indexOf=function(t,n,e){if(null==t)return-1;var i=0,r=t.length;if(e){if("number"!=typeof e)return i=T.sortedIndex(t,n),t[i]===n?i:-1;i=0>e?Math.max(0,r+e):e}if(y&&t.indexOf===y)return t.indexOf(n,e);for(;r>i;i++)if(t[i]===n)return i;return-1},T.lastIndexOf=function(t,n,e){if(null==t)return-1;var i=null!=e;if(x&&t.lastIndexOf===x)return i?t.lastIndexOf(n,e):t.lastIndexOf(n);for(var r=i?e:t.length;r--;)if(t[r]===n)return r;return-1},T.range=function(t,n,e){arguments.length<=1&&(n=t||0,t=0),e=arguments[2]||1;for(var i=Math.max(Math.ceil((n-t)/e),0),r=0,o=new Array(i);i>r;)o[r++]=t,t+=e;return o};var D=function(){};T.bind=function(t,n){var e,i;if(z&&t.bind===z)return z.apply(t,u.call(arguments,1));if(!T.isFunction(t))throw new TypeError;return e=u.call(arguments,2),i=function(){if(!(this instanceof i))return t.apply(n,e.concat(u.call(arguments)));D.prototype=t.prototype;var r=new D;D.prototype=null;var o=t.apply(r,e.concat(u.call(arguments)));return Object(o)===o?o:r}},T.partial=function(t){var n=u.call(arguments,1);return function(){return t.apply(this,n.concat(u.call(arguments)))}},T.bindAll=function(t){var n=u.call(arguments,1);if(0===n.length)throw new Error("bindAll must be passed function names");return A(n,function(n){t[n]=T.bind(t[n],t)}),t},T.memoize=function(t,n){var e={};return n||(n=T.identity),function(){var i=n.apply(this,arguments);return T.has(e,i)?e[i]:e[i]=t.apply(this,arguments)}},T.delay=function(t,n){var e=u.call(arguments,2);return setTimeout(function(){return t.apply(null,e)},n)},T.defer=function(t){return T.delay.apply(T,[t,1].concat(u.call(arguments,1)))},T.throttle=function(t,n,e){var i,r,o,a=null,u=0;e||(e={});var s=function(){u=e.leading===!1?0:new Date,a=null,o=t.apply(i,r)};return function(){var c=new Date;u||e.leading!==!1||(u=c);var l=n-(c-u);return i=this,r=arguments,0>=l?(clearTimeout(a),a=null,u=c,o=t.apply(i,r)):a||e.trailing===!1||(a=setTimeout(s,l)),o}},T.debounce=function(t,n,e){var i,r=null;return function(){var o=this,a=arguments,u=function(){r=null,e||(i=t.apply(o,a))},s=e&&!r;return clearTimeout(r),r=setTimeout(u,n),s&&(i=t.apply(o,a)),i}},T.once=function(t){var n,e=!1;return function(){return e?n:(e=!0,n=t.apply(this,arguments),t=null,n)}},T.wrap=function(t,n){return function(){var e=[t];return a.apply(e,arguments),n.apply(this,e)}},T.compose=function(){var t=arguments;return function(){for(var n=arguments,e=t.length-1;e>=0;e--)n=[t[e].apply(this,n)];return n[0]}},T.after=function(t,n){return function(){return--t<1?n.apply(this,arguments):void 0}},T.keys=w||function(t){if(t!==Object(t))throw new TypeError("Invalid object");var n=[];for(var e in t)T.has(t,e)&&n.push(e);return n},T.values=function(t){var n=[];for(var e in t)T.has(t,e)&&n.push(t[e]);return n},T.pairs=function(t){var n=[];for(var e in t)T.has(t,e)&&n.push([e,t[e]]);return n},T.invert=function(t){var n={};for(var e in t)T.has(t,e)&&(n[t[e]]=e);return n},T.functions=T.methods=function(t){var n=[];for(var e in t)T.isFunction(t[e])&&n.push(e);return n.sort()},T.extend=function(t){return A(u.call(arguments,1),function(n){if(n)for(var e in n)t[e]=n[e]}),t},T.pick=function(t){var n={},e=s.apply(i,u.call(arguments,1));return A(e,function(e){e in t&&(n[e]=t[e])}),n},T.omit=function(t){var n={},e=s.apply(i,u.call(arguments,1));for(var r in t)T.contains(e,r)||(n[r]=t[r]);return n},T.defaults=function(t){return A(u.call(arguments,1),function(n){if(n)for(var e in n)void 0===t[e]&&(t[e]=n[e])}),t},T.clone=function(t){return T.isObject(t)?T.isArray(t)?t.slice():T.extend({},t):t},T.tap=function(t,n){return n(t),t};var Z=function(t,n,e,i){if(t===n)return 0!==t||1/t==1/n;if(null==t||null==n)return t===n;t instanceof T&&(t=t._wrapped),n instanceof T&&(n=n._wrapped);var r=c.call(t);if(r!=c.call(n))return!1;switch(r){case"[object String]":return t==String(n);case"[object Number]":return t!=+t?n!=+n:0==t?1/t==1/n:t==+n;case"[object Date]":case"[object Boolean]":return+t==+n;case"[object RegExp]":return t.source==n.source&&t.global==n.global&&t.multiline==n.multiline&&t.ignoreCase==n.ignoreCase}if("object"!=typeof t||"object"!=typeof n)return!1;for(var o=e.length;o--;)if(e[o]==t)return i[o]==n;var a=t.constructor,u=n.constructor;if(a!==u&&!(T.isFunction(a)&&a instanceof a&&T.isFunction(u)&&u instanceof u))return!1;e.push(t),i.push(n);var s=0,l=!0;if("[object Array]"==r){if(s=t.length,l=s==n.length)for(;s--&&(l=Z(t[s],n[s],e,i)););}else{for(var f in t)if(T.has(t,f)&&(s++,!(l=T.has(n,f)&&Z(t[f],n[f],e,i))))break;if(l){for(f in n)if(T.has(n,f)&&!s--)break;l=!s}}return e.pop(),i.pop(),l};T.isEqual=function(t,n){return Z(t,n,[],[])},T.isEmpty=function(t){if(null==t)return!0;if(T.isArray(t)||T.isString(t))return 0===t.length;for(var n in t)if(T.has(t,n))return!1;return!0},T.isElement=function(t){return!(!t||1!==t.nodeType)},T.isArray=b||function(t){return"[object Array]"==c.call(t)},T.isObject=function(t){return t===Object(t)},A(["Arguments","Function","String","Number","Date","RegExp"],function(t){T["is"+t]=function(n){return c.call(n)=="[object "+t+"]"}}),T.isArguments(arguments)||(T.isArguments=function(t){return!(!t||!T.has(t,"callee"))}),"function"!=typeof/./&&(T.isFunction=function(t){return"function"==typeof t}),T.isFinite=function(t){return isFinite(t)&&!isNaN(parseFloat(t))},T.isNaN=function(t){return T.isNumber(t)&&t!=+t},T.isBoolean=function(t){return t===!0||t===!1||"[object Boolean]"==c.call(t)},T.isNull=function(t){return null===t},T.isUndefined=function(t){return void 0===t},T.has=function(t,n){return l.call(t,n)},T.noConflict=function(){return t._=n,this},T.identity=function(t){return t},T.times=function(t,n,e){for(var i=Array(Math.max(0,t)),r=0;t>r;r++)i[r]=n.call(e,r);return i},T.random=function(t,n){return null==n&&(n=t,t=0),t+Math.floor(Math.random()*(n-t+1))};var k={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","/":"&#x2F;"}};k.unescape=T.invert(k.escape);var M={escape:new RegExp("["+T.keys(k.escape).join("")+"]","g"),unescape:new RegExp("("+T.keys(k.unescape).join("|")+")","g")};T.each(["escape","unescape"],function(t){T[t]=function(n){return null==n?"":(""+n).replace(M[t],function(n){return k[t][n]})}}),T.result=function(t,n){if(null!=t){var e=t[n];return T.isFunction(e)?e.call(t):e}},T.mixin=function(t){A(T.functions(t),function(n){var e=T[n]=t[n];T.prototype[n]=function(){var t=[this._wrapped];return a.apply(t,arguments),P.call(this,e.apply(T,t))}})};var I=0;T.uniqueId=function(t){var n=++I+"";return t?t+n:n},T.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var C=/(.)^/,R={"'":"'","\\":"\\","\r":"r","\n":"n","	":"t","\u2028":"u2028","\u2029":"u2029"},S=/\\|'|\r|\n|\t|\u2028|\u2029/g;T.template=function(t,n,e){var i;e=T.defaults({},e,T.templateSettings);var r=new RegExp([(e.escape||C).source,(e.interpolate||C).source,(e.evaluate||C).source].join("|")+"|$","g"),o=0,a="__p+='";t.replace(r,function(n,e,i,r,u){return a+=t.slice(o,u).replace(S,function(t){return"\\"+R[t]}),e&&(a+="'+\n((__t=("+e+"))==null?'':_.escape(__t))+\n'"),i&&(a+="'+\n((__t=("+i+"))==null?'':__t)+\n'"),r&&(a+="';\n"+r+"\n__p+='"),o=u+n.length,n}),a+="';\n",e.variable||(a="with(obj||{}){\n"+a+"}\n"),a="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+a+"return __p;\n";try{i=new Function(e.variable||"obj","_",a)}catch(u){throw u.source=a,u}if(n)return i(n,T);var s=function(t){return i.call(this,t,T)};return s.source="function("+(e.variable||"obj")+"){\n"+a+"}",s},T.chain=function(t){return T(t).chain()};var P=function(t){return this._chain?T(t).chain():t};T.mixin(T),A(["pop","push","reverse","shift","sort","splice","unshift"],function(t){var n=i[t];T.prototype[t]=function(){var e=this._wrapped;return n.apply(e,arguments),"shift"!=t&&"splice"!=t||0!==e.length||delete e[0],P.call(this,e)}}),A(["concat","join","slice"],function(t){var n=i[t];T.prototype[t]=function(){return P.call(this,n.apply(this._wrapped,arguments))}}),T.extend(T.prototype,{chain:function(){return this._chain=!0,this},value:function(){return this._wrapped}})}.call(this),function(){"use strict";var t=function($,t){var n=function(n,e){this.el=$(n),this.zoomFactor=1,this.lastScale=1,this.offset={x:0,y:0},this.options=t.extend(this.defaults,e),this.setupMarkup(),this.bindEvents(),this.update()},e=function(t,n){return t+n},i=function(t,n){return t>n-.01&&n+.01>t};n.prototype={defaults:{tapZoomFactor:2,zoomOutFactor:1.3,animationDuration:300,animationInterval:5,maxZoom:4,minZoom:.5,use2d:!0},handleDragStart:function(t){this.stopAnimation(),this.lastDragPosition=!1,this.hasInteraction=!0,this.handleDrag(t)},handleDrag:function(t){if(this.zoomFactor>1){var n=this.getTouches(t)[0];this.drag(n,this.lastDragPosition),this.offset=this.sanitizeOffset(this.offset),this.lastDragPosition=n}},handleDragEnd:function(){this.end()},handleZoomStart:function(t){this.stopAnimation(),this.lastScale=1,this.nthZoom=0,this.lastZoomCenter=!1,this.hasInteraction=!0},handleZoom:function(t,n){var e=this.getTouchCenter(this.getTouches(t)),i=n/this.lastScale;this.lastScale=n,this.nthZoom+=1,this.nthZoom>3&&(this.scale(i,e),this.drag(e,this.lastZoomCenter)),this.lastZoomCenter=e},handleZoomEnd:function(){this.end()},handleDoubleTap:function(n){var e=this.getTouches(n)[0],i=this.zoomFactor>1?1:this.options.tapZoomFactor,r=this.zoomFactor,o=t.bind(function(t){this.scaleTo(r+t*(i-r),e)},this);this.hasInteraction||(r>i&&(e=this.getCurrentZoomCenter()),this.animate(this.options.animationDuration,this.options.animationInterval,o,this.swing))},sanitizeOffset:function(t){var n=(this.zoomFactor-1)*this.getContainerX(),e=(this.zoomFactor-1)*this.getContainerY(),i=Math.max(n,0),r=Math.max(e,0),o=Math.min(n,0),a=Math.min(e,0);return{x:Math.min(Math.max(t.x,o),i),y:Math.min(Math.max(t.y,a),r)}},scaleTo:function(t,n){this.scale(t/this.zoomFactor,n)},scale:function(t,n){t=this.scaleZoomFactor(t),this.addOffset({x:(t-1)*(n.x+this.offset.x),y:(t-1)*(n.y+this.offset.y)})},scaleZoomFactor:function(t){var n=this.zoomFactor;return this.zoomFactor*=t,this.zoomFactor=Math.min(this.options.maxZoom,Math.max(this.zoomFactor,this.options.minZoom)),this.zoomFactor/n},drag:function(t,n){n&&this.addOffset({x:-(t.x-n.x),y:-(t.y-n.y)})},getTouchCenter:function(t){return this.getVectorAvg(t)},getVectorAvg:function(n){return{x:t.reduce(t.pluck(n,"x"),e)/n.length,y:t.reduce(t.pluck(n,"y"),e)/n.length}},addOffset:function(t){this.offset={x:this.offset.x+t.x,y:this.offset.y+t.y}},sanitize:function(){this.zoomFactor<this.options.zoomOutFactor?this.zoomOutAnimation():this.isInsaneOffset(this.offset)&&this.sanitizeOffsetAnimation()},isInsaneOffset:function(t){var n=this.sanitizeOffset(t);return n.x!==t.x||n.y!==t.y},sanitizeOffsetAnimation:function(){var n=this.sanitizeOffset(this.offset),e={x:this.offset.x,y:this.offset.y},i=t.bind(function(t){this.offset.x=e.x+t*(n.x-e.x),this.offset.y=e.y+t*(n.y-e.y),this.update()},this);this.animate(this.options.animationDuration,this.options.animationInterval,i,this.swing)},zoomOutAnimation:function(){var n=this.zoomFactor,e=1,i=this.getCurrentZoomCenter(),r=t.bind(function(t){this.scaleTo(n+t*(e-n),i)},this);this.animate(this.options.animationDuration,this.options.animationInterval,r,this.swing)},updateAspectRatio:function(){this.setContainerY(this.getContainerX()/this.getAspectRatio())},getInitialZoomFactor:function(){return this.container.width()/this.el.width()},getAspectRatio:function(){return this.el.width()/this.el.height()},getCurrentZoomCenter:function(){var t=this.container.width()*this.zoomFactor,n=this.offset.x,e=t-n-this.container.width(),i=n/e,r=i*this.container.width()/(i+1),o=this.container.height()*this.zoomFactor,a=this.offset.y,u=o-a-this.container.height(),s=a/u,c=s*this.container.height()/(s+1);return 0===e&&(r=this.container.width()),0===u&&(c=this.container.height()),{x:r,y:c}},canDrag:function(){return!i(this.zoomFactor,1)},getTouches:function(n){var e=this.container.offset();return t.map(n.touches,function(t){return{x:t.pageX-e.left,y:t.pageY-e.top}})},animate:function(n,e,i,r,o){var a=(new Date).getTime(),u=t.bind(function(){if(this.inAnimation){var t=(new Date).getTime()-a,s=t/n;t>=n?(i(1),o&&o(),this.update(),this.stopAnimation(),this.update()):(r&&(s=r(s)),i(s),this.update(),setTimeout(u,e))}},this);this.inAnimation=!0,u()},stopAnimation:function(){this.inAnimation=!1},swing:function(t){return-Math.cos(t*Math.PI)/2+.5},getContainerX:function(){return this.container.width()},getContainerY:function(){return this.container.height()},setContainerY:function(t){return this.container.height(t)},setupMarkup:function(){this.container=$('<div class="pinch-zoom-container"></div>'),this.el.before(this.container),this.container.append(this.el),this.container.css({overflow:"hidden",position:"relative"}),this.el.css({webkitTransformOrigin:"0% 0%",mozTransformOrigin:"0% 0%",msTransformOrigin:"0% 0%",oTransformOrigin:"0% 0%",transformOrigin:"0% 0%",position:"absolute"})},end:function(){this.hasInteraction=!1,this.sanitize(),this.update()},bindEvents:function(){r(this.container.get(0),this),$(window).bind("resize",t.bind(this.update,this)),$(this.el).find("img").bind("load",t.bind(this.update,this))},update:function(){this.updatePlaned||(this.updatePlaned=!0,setTimeout(t.bind(function(){this.updatePlaned=!1,this.updateAspectRatio();var n=this.getInitialZoomFactor()*this.zoomFactor,e=-this.offset.x/n,i=-this.offset.y/n,r="scale3d("+n+", "+n+",1) translate3d("+e+"px,"+i+"px,0px)",o="scale("+n+", "+n+") translate("+e+"px,"+i+"px)",a=t.bind(function(){this.clone&&(this.clone.remove(),delete this.clone)},this);!this.options.use2d||this.hasInteraction||this.inAnimation?(this.is3d=!0,a(),this.el.css({webkitTransform:r,oTransform:o,msTransform:o,mozTransform:o,transform:r})):(this.is3d&&(this.clone=this.el.clone(),this.clone.css("pointer-events","none"),this.clone.appendTo(this.container),setTimeout(a,200)),this.el.css({webkitTransform:o,oTransform:o,msTransform:o,mozTransform:o,transform:o}),this.is3d=!1)},this),0))}};var r=function(n,e){var i=null,r=0,o=null,a=null,u=function(t,n){if(i!==t){if(i&&!t)switch(i){case"zoom":e.handleZoomEnd(n);break;case"drag":e.handleDragEnd(n)}switch(t){case"zoom":e.handleZoomStart(n);break;case"drag":e.handleDragStart(n)}}i=t},s=function(t){2===r?u("zoom"):1===r&&e.canDrag()?u("drag",t):u(null,t)},c=function(n){return t.map(n,function(t){return{x:t.pageX,y:t.pageY}})},l=function(t,n){var e,i;return e=t.x-n.x,i=t.y-n.y,Math.sqrt(e*e+i*i)},f=function(t,n){var e=l(t[0],t[1]),i=l(n[0],n[1]);return i/e},h=function(t){t.stopPropagation(),t.preventDefault()},p=function(t){var n=(new Date).getTime();if(r>1&&(o=null),300>n-o)switch(h(t),e.handleDoubleTap(t),i){case"zoom":e.handleZoomEnd(t);break;case"drag":e.handleDragEnd(t)}1===r&&(o=n)},m=!0;n.addEventListener("touchstart",function(t){m=!0,r=t.touches.length,p(t)}),n.addEventListener("touchmove",function(t){if(m)s(t),i&&h(t),a=c(t.touches);else{switch(i){case"zoom":e.handleZoom(t,f(a,c(t.touches)));break;case"drag":e.handleDrag(t)}i&&(h(t),e.update())}m=!1}),n.addEventListener("touchend",function(t){r=t.touches.length,s(t)})};return n};"undefined"!=typeof define&&define.amd?define(["jquery","underscore"],function($,n){return t($,n)}):(window.RTP=window.RTP||{},window.RTP.PinchZoom=t(jQuery,_))}.call(this);